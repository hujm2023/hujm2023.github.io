<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>LeetCode-位运算 | hujm2023&#39;s blog</title>
<meta name="keywords" content="LeetCode, 数组, 位运算">
<meta name="description" content="位运算
位运算讲究技巧，需要多积累经验。
一、背景知识
Go 语言支持的 位运算符 如下：

  
      
          运算符
          描述
          规则
      
  
  
      
          &amp;
          按位 与
          二者同为 1 时结果才为 1，否则为 0
      
      
          |
          按位 或
          二者同为 0 时结果才为 0，否则是 1
      
      
          ^
          按位 异或
          相同为 0，相异为 1
      
      
          &laquo;
          左移 n 位，相当于乘以 2 的 n 次方
          后面补 0
      
      
          &raquo;
          右移一位，相当于除以 2 的 n 次方
          截掉最后一位
      
  

1. 与
将参与运算的两个数 各对应的二进制位 相与。只有当二者参与运算的对应位同为 1 时，该位才为 1，否则为 0。">
<meta name="author" content="JemmyHu(hujm20151021@gmail.com)">
<link rel="canonical" href="http://localhost:1313/posts/leetcode-%E4%BD%8D%E8%BF%90%E7%AE%97/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a090830a421002426baafbd314e38f149d77b4c48a12ee9312700d770b27fb26.css" integrity="sha256-oJCDCkIQAkJrqvvTFOOPFJ13tMSKEu6TEnANdwsn&#43;yY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/leetcode-%E4%BD%8D%E8%BF%90%E7%AE%97/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="hujm2023&#39;s blog (Alt + H)">hujm2023&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="首页">
                    <span>首页</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/" title="文章">
                    <span>文章</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="搜索">
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      LeetCode-位运算
    </h1>
    <div class="post-meta"><span title='2020-09-22 00:25:09 +0000 UTC'>September 22, 2020</span>&nbsp;·&nbsp;<span>JemmyHu(hujm20151021@gmail.com)</span>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="eager" src="https://pic.downk.cc/item/5f68d466160a154a67c8ff74.jpg" alt="">
        
</figure>
  <div class="post-content"><h1 id="位运算">位运算<a hidden class="anchor" aria-hidden="true" href="#位运算">#</a></h1>
<p>位运算讲究技巧，需要多积累经验。</p>
<h2 id="一背景知识">一、背景知识<a hidden class="anchor" aria-hidden="true" href="#一背景知识">#</a></h2>
<p>Go 语言支持的 <strong>位运算符</strong> 如下：</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center">运算符</th>
          <th style="text-align: center">描述</th>
          <th style="text-align: center">规则</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">&amp;</td>
          <td style="text-align: center">按位 <strong>与</strong></td>
          <td style="text-align: center">二者同为 1 时结果才为 1，否则为 0</td>
      </tr>
      <tr>
          <td style="text-align: center">|</td>
          <td style="text-align: center">按位 <strong>或</strong></td>
          <td style="text-align: center">二者同为 0 时结果才为 0，否则是 1</td>
      </tr>
      <tr>
          <td style="text-align: center">^</td>
          <td style="text-align: center">按位 <strong>异或</strong></td>
          <td style="text-align: center">相同为 0，相异为 1</td>
      </tr>
      <tr>
          <td style="text-align: center">&laquo;</td>
          <td style="text-align: center"><strong>左移 n 位，相当于乘以 2 的 n 次方</strong></td>
          <td style="text-align: center">后面补 0</td>
      </tr>
      <tr>
          <td style="text-align: center">&raquo;</td>
          <td style="text-align: center"><strong>右移一位，相当于除以 2 的 n 次方</strong></td>
          <td style="text-align: center">截掉最后一位</td>
      </tr>
  </tbody>
</table>
<h3 id="1-与">1. 与<a hidden class="anchor" aria-hidden="true" href="#1-与">#</a></h3>
<p>将参与运算的两个数 各对应的二进制位 相与。只有当二者参与运算的<strong>对应位同为 1 时，该位才为 1，否则为 0</strong>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">a</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">60</span>  <span style="color:#75715e">// 0011 1100</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">b</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">23</span>  <span style="color:#75715e">// 0001 0111</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">a</span> <span style="color:#f92672">&amp;</span> <span style="color:#a6e22e">b</span>)  <span style="color:#75715e">// 0001 0100</span>
</span></span></code></pre></div><p>上述例子中，我们从最后一位开始，逐位运算。可以看到只有 <code>倒数第3位</code> 和 <code>倒数第5位</code> 都是 1，结果中也只有倒数第 3 位和倒数第 5 位是 1。</p>
<p><strong>规律：</strong></p>
<ul>
<li><strong><code>任何数 &amp; 0 = 0</code></strong>；</li>
<li><strong><code>任何数 &amp; 任何数 = 任何数</code></strong>；</li>
</ul>
<h3 id="2或">2.或<a hidden class="anchor" aria-hidden="true" href="#2或">#</a></h3>
<p>将参与运算的两个数 各对应的二进制位 相或。只有当二者<strong>对应位全部是 0 时，该位结果才是 0，其他情况结果全为 1</strong>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">a</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">60</span>  <span style="color:#75715e">// 0011 1100</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">b</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">23</span>  <span style="color:#75715e">// 0001 0111</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">a</span> | <span style="color:#a6e22e">b</span>)  <span style="color:#75715e">// 0011 1111</span>
</span></span></code></pre></div><p><strong>规律：</strong></p>
<ul>
<li><strong><code>任何数 | 0 = 任何数</code></strong></li>
<li><strong><code>任何数 | 任何数 = 任何数</code></strong></li>
</ul>
<h3 id="3-异或">3. 异或<a hidden class="anchor" aria-hidden="true" href="#3-异或">#</a></h3>
<p>逐位异或，<strong>对应位相同，结果为 0，否则为 1</strong>——可以理解为 <strong>“抵消 1”</strong> 效果。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">a</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">60</span>  <span style="color:#75715e">// 0011 1100</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">b</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">23</span>  <span style="color:#75715e">// 0001 0111</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">a</span> | <span style="color:#a6e22e">b</span>)  <span style="color:#75715e">// 0010 1011</span>
</span></span></code></pre></div><p><strong>规律：</strong></p>
<ul>
<li><strong><code>任何数 ^ 任何数 = 0</code></strong></li>
<li><strong><code>任何数 ^ 0 = 任何数</code></strong></li>
<li><strong><code>任何数 ^ 1 = ~任何数</code></strong>(按位取反)</li>
</ul>
<h2 id="二经典题目">二、经典题目<a hidden class="anchor" aria-hidden="true" href="#二经典题目">#</a></h2>
<h3 id="1-二进制中-1-的个数">1. 二进制中 1 的个数<a hidden class="anchor" aria-hidden="true" href="#1-二进制中-1-的个数">#</a></h3>
<ul>
<li>LeetCode 题目： <a href="https://leetcode-cn.com/problems/number-of-1-bits/">191. 位 1 的个数</a></li>
</ul>
<h4 id="11-题目描述">1.1 题目描述<a hidden class="anchor" aria-hidden="true" href="#11-题目描述">#</a></h4>
<blockquote>
<p>请实现一个函数，输入一个整数，输出该数二进制表示中 1 的个数。例如，把 9 表示成二进制是 1001，有 2 位是 1。因此，如果输入 9，则该函数输出 2。</p>
<p>举例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>输入：00000000000000000000000000001011
</span></span><span style="display:flex;"><span>输出：3
</span></span><span style="display:flex;"><span>解释：输入的二进制串 00000000000000000000000000001011 中，共有三位为 <span style="color:#e6db74">&#39;1&#39;</span>。
</span></span></code></pre></div></blockquote>
<h4 id="12-思路">1.2 思路<a hidden class="anchor" aria-hidden="true" href="#12-思路">#</a></h4>
<h5 id="思路-1">思路 1<a hidden class="anchor" aria-hidden="true" href="#思路-1">#</a></h5>
<p>最后一位通过和 1 进行 <strong>与运算</strong>，可以判断最后一位是否为 1；然后将要计算的数字向右移动 1 位，再计算是否最后一位是否为 1。逐渐循环，知道直到要计算的数变成 0。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">hammingWeight</span>(<span style="color:#a6e22e">num</span> <span style="color:#66d9ef">uint32</span>) <span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>  <span style="color:#75715e">// 保存1出现的次数</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">num</span> &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">num</span><span style="color:#f92672">&amp;</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">result</span><span style="color:#f92672">++</span>  <span style="color:#75715e">// 最后一位是 1</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">num</span> <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>  <span style="color:#75715e">// 将原数右移一位</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h5 id="思路-2">思路 2<a hidden class="anchor" aria-hidden="true" href="#思路-2">#</a></h5>
<p>某一位通过和 1 进行 <strong>与运算</strong>，可以判断该位是是否为 1。题目指定了 32 位无符号整数，那么循环 32 次，从最后一位开始逐位判断，如何向前移动？左移一位即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">hammingWeight</span>(<span style="color:#a6e22e">num</span> <span style="color:#66d9ef">uint32</span>) <span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">result</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">base</span> <span style="color:#f92672">:=</span> uint32(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#ae81ff">32</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">base</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">num</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">result</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">base</span> <span style="color:#f92672">&lt;&lt;=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h5 id="思路-3">思路 3<a hidden class="anchor" aria-hidden="true" href="#思路-3">#</a></h5>
<p>出发点：<strong>n &amp; (n-1)</strong>，会消除 n 最后一个 1。因此，<code>n &amp; (n-1)</code> 总是能把 <code>n</code>中最低位的 1 变成 0 ，并保持其他位不变。具体什么原因，暂时不做深究。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">hammingWeight</span>(<span style="color:#a6e22e">num</span> <span style="color:#66d9ef">uint32</span>) <span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">num</span> &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">result</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">num</span> <span style="color:#f92672">&amp;=</span> <span style="color:#a6e22e">num</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="2-判断一个数是否为-2-的幂">2. 判断一个数是否为 2 的幂<a hidden class="anchor" aria-hidden="true" href="#2-判断一个数是否为-2-的幂">#</a></h3>
<ul>
<li>LeetCode 题目：<a href="https://leetcode-cn.com/problems/power-of-two/">231. 2 的幂</a></li>
</ul>
<h4 id="21-题目描述">2.1 题目描述<a hidden class="anchor" aria-hidden="true" href="#21-题目描述">#</a></h4>
<blockquote>
<p>给定一个整数，编写一个函数来判断它是否是 2 的幂次方。</p>
<p>示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>输入: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>输出: true
</span></span><span style="display:flex;"><span>解释: 20 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div></blockquote>
<h4 id="22-解题思路">2.2 解题思路<a hidden class="anchor" aria-hidden="true" href="#22-解题思路">#</a></h4>
<p>如果将 2 的所有次幂的二进制写出来，你会发现这些数的规律：最高位都是 1，其余位全是 0。也就是说，如果一个数为 2 的次幂，那么它只有一个 1，而且是在最高位，同时也是最后一个 1。再回想一下上一题中的思路三，<code>n &amp; (n-1)</code> 会消除最后一个 1，于是乎：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">isPowerOfTwo</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span> &gt; <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">n</span><span style="color:#f92672">&amp;</span>(<span style="color:#a6e22e">n</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="3-使用位运算求和">3. 使用位运算求和<a hidden class="anchor" aria-hidden="true" href="#3-使用位运算求和">#</a></h3>
<ul>
<li>LeetCode 题目：<a href="https://leetcode-cn.com/problems/bu-yong-jia-jian-cheng-chu-zuo-jia-fa-lcof/">剑指 Offer 65. 不用加减乘除做加法</a></li>
</ul>
<h4 id="31-题目描述">3.1 题目描述<a hidden class="anchor" aria-hidden="true" href="#31-题目描述">#</a></h4>
<blockquote>
<p>写一个函数，求两个整数之和，要求在函数体内不得使用 “+”、“-”、“*”、“/” 四则运算符号。</p>
<p>举例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>输入: a <span style="color:#f92672">=</span> 1, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>输出: <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><p>提示：</p>
<ul>
<li><code>a</code>, <code>b</code> 均可能是负数或 0</li>
<li>结果不会溢出 32 位整数</li>
</ul></blockquote>
<h4 id="32-解题思路">3.2 解题思路<a hidden class="anchor" aria-hidden="true" href="#32-解题思路">#</a></h4>
<p>我们用 <code>n</code> 表示<strong>无进位和</strong>，<code>c</code> 表示<strong>进位</strong>，那么 <code>sum = a + b = n + c</code>，而位运算可以分别计算出 <code>n</code> 和 <code>c</code>。以两个 1 位的二进制数求和为例：</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center">a</th>
          <th style="text-align: center">b</th>
          <th style="text-align: center">无进位和 n</th>
          <th style="text-align: center">进位 c</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">0</td>
          <td style="text-align: center">0</td>
          <td style="text-align: center">0</td>
          <td style="text-align: center">0</td>
      </tr>
      <tr>
          <td style="text-align: center">0</td>
          <td style="text-align: center">1</td>
          <td style="text-align: center">1</td>
          <td style="text-align: center">0</td>
      </tr>
      <tr>
          <td style="text-align: center">1</td>
          <td style="text-align: center">0</td>
          <td style="text-align: center">1</td>
          <td style="text-align: center">0</td>
      </tr>
      <tr>
          <td style="text-align: center">1</td>
          <td style="text-align: center">1</td>
          <td style="text-align: center">0</td>
          <td style="text-align: center">10</td>
      </tr>
  </tbody>
</table>
<p>从上表中可以看出，<code>n = a ^ b</code>，<code>c = (a&amp;b) &lt;&lt; 1</code>。借用 <code>leetcode</code> 上大神的一张图：</p>
<p><img alt="使用位运算求和" loading="lazy" src="https://pic.downk.cc/item/5f695927160a154a6701b43d.png"></p>
<p>但是在 <code>sum = n + c</code> 中还是使用了加法，而这种情况我们依旧可以使用上面的规律。这里可以使用一个循环来解决，需要存储<code>n</code> 和 <code>c</code>，循环直到<code>c = 0</code> 时停止，而此时<code>n</code> 即为结果。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">add</span>(<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">b</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * 循环解法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        for b != 0 {
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">            b, a = (a&amp;b) &lt;&lt; 1, a ^ b
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        }
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        return a
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * 递归解法，比上面的循环解法更清晰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     if b == 0 {
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     	return a
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     }
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     return add(a ^ b, (a &amp; b) &lt;&lt; 1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    */</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="4-数组中出现的次数">4. 数组中出现的次数<a hidden class="anchor" aria-hidden="true" href="#4-数组中出现的次数">#</a></h3>
<ul>
<li>LeetCode 题目：<a href="https://leetcode-cn.com/problems/single-number/">136. 只出现一次的数字</a></li>
</ul>
<h4 id="41-题目描述">4.1 题目描述<a hidden class="anchor" aria-hidden="true" href="#41-题目描述">#</a></h4>
<blockquote>
<p>给定一个非空整数数组，除了某个元素只出现一次以外，其余每个元素均出现两次。找出那个只出现了一次的元素。</p>
<p>说明：</p>
<p>你的算法应该具有线性时间复杂度。 你可以不使用额外空间来实现吗？</p>
<p>示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>输入: <span style="color:#f92672">[</span>2,2,1<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>输出: <span style="color:#ae81ff">1</span>
</span></span></code></pre></div></blockquote>
<h4 id="42-解题思路">4.2 解题思路<a hidden class="anchor" aria-hidden="true" href="#42-解题思路">#</a></h4>
<p>回想前面背景知识中的 <strong>异或</strong> 的特性：<strong><code>任何数 ^ 任何数 = 0</code></strong>，并且 <strong><code>任何数 ^ 0 = 任何数</code></strong>。所以思路很明显，全部进行 <strong>异或</strong> 操作，出现两次的都会被“抵消”，最后剩下那个“没人要的”，就是我们要找的。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">singleNumber</span>(<span style="color:#a6e22e">nums</span> []<span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">nums</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// 整体异或运算</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span><span style="color:#f92672">:=</span><span style="color:#ae81ff">1</span>;<span style="color:#a6e22e">i</span>&lt;len(<span style="color:#a6e22e">nums</span>);<span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">nums</span>[<span style="color:#ae81ff">0</span>] ^= <span style="color:#a6e22e">nums</span>[<span style="color:#a6e22e">i</span>]  <span style="color:#75715e">// 使用已有数组的第0个位置，节省空间</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">nums</span>[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="43-进阶只出现一次的数字-ii">4.3 进阶——只出现一次的数字 II<a hidden class="anchor" aria-hidden="true" href="#43-进阶只出现一次的数字-ii">#</a></h4>
<ul>
<li>LeetCode 题目：<a href="https://leetcode-cn.com/problems/single-number-ii/">137. 只出现一次的数字 II</a></li>
</ul>
<blockquote>
<p>给定一个非空整数数组，除了某个元素只出现一次以外，其余每个元素均出现了三次。找出那个只出现了一次的元素。</p>
<p>说明：</p>
<p>你的算法应该具有线性时间复杂度。 你可以不使用额外空间来实现吗？</p>
<p>示例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>输入: <span style="color:#f92672">[</span>2,2,3,2<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>输出: <span style="color:#ae81ff">3</span>
</span></span></code></pre></div></blockquote>
<p>使用一个 map 的解法这里没必要说了，因为使用了额外空间。</p>
<h5 id="思路-1-1">思路 1<a hidden class="anchor" aria-hidden="true" href="#思路-1-1">#</a></h5>
<p>使用数学规律法——<strong>原数组去重、再乘以 3 得到的值，刚好就是要找的元素的 2 倍</strong>。Go 中没有 <code>set</code> 的这种数据结构，这里提供 Python 解法：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">singleNumber</span>(nums){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> int((sum(set(nums))<span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> sum(nums))<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h5 id="思路-2-1">思路 2<a hidden class="anchor" aria-hidden="true" href="#思路-2-1">#</a></h5>
<p>回想之前的 <strong>异或</strong>，发现有两个 1，该位结果是 0；二进制加法中，两个 1 相加，产生了进位，抛弃进位，其结果也是 0——这个过程，可以看成是<strong>对应位上 1 的个数对 2 取模的结果</strong>。如果是三个数呢？是不是三个数的对应位都是 1 的时候，该位结果才是 0，否则就是 1——对应位上的 1 的个数对 3 取模即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">singleNumber</span>(<span style="color:#a6e22e">nums</span> []<span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#ae81ff">64</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// int至少32位，一般都是64位</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 初始化每一位1的个数为0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">number</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">k</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">nums</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 通过右移i位的方式，计算每一位1的个数</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">number</span> <span style="color:#f92672">+=</span> (<span style="color:#a6e22e">k</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#a6e22e">i</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 对3取模后 最终将抵消后剩余的1放到对应的位数上</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">res</span> <span style="color:#f92672">|=</span> (<span style="color:#a6e22e">number</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#a6e22e">i</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>再如果 <strong>除 1 个元素外，每个元素出现了 4 次</strong>呢？原理一样，对 4 取模即可。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/leetcode/">LeetCode</a></li>
      <li><a href="http://localhost:1313/tags/%E6%95%B0%E7%BB%84/">数组</a></li>
      <li><a href="http://localhost:1313/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/">位运算</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">hujm2023&#39;s blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
